<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>花選びアプリ - Atelier Flannel shiraoka</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>
　<header>
<header class="hero-header">
  <h1>ATELIER FLANNEL&nbsp;SHIRAOKA</h1>
</header>
　</header>

  <main>
    <section id="intro">
      <p>今日はどんな花を選びましょうか？</p>
    </section>

    <section id="choices">
      <button class="choice-btn" data-type="birthday">誕生日プレゼント</button>
      <button class="choice-btn" data-type="hospital">お見舞い</button>
      <button class="choice-btn" data-type="farewell">送別・退職祝い</button>
      <button class="choice-btn" data-type="casual">ちょっとした贈り物</button>
      <button class="choice-btn" id="lang-btn">花言葉から選ぶ</button>
      <button class="choice-btn" id="ai-btn">AIに聞く</button>
    </section>

    <section id="results" style="display:none;">
      <h2 id="result-title"></h2>
      <div id="flower-list"></div>
      <button id="back-btn">トップへ戻る</button>
    </section>
  </main>

  <footer>
    <p><a href="#">Instagramを見る</a> | <a href="#">店舗情報</a></p>
  </footer>

  <script>
    let flowers = [];

    // JSON 読み込み
    fetch('./flowers.json')
      .then(res => res.json())
      .then(data => { flowers = data; console.log('flowers loaded', flowers); });

    const choiceButtons = document.querySelectorAll('.choice-btn[data-type]');
    const resultSection = document.getElementById('results');
    const list = document.getElementById('flower-list');
    const title = document.getElementById('result-title');
    const backBtn = document.getElementById('back-btn');

    choiceButtons.forEach(btn => btn.addEventListener('click', () => {
      const type = btn.dataset.type;
      showResults(type);
    }));

    backBtn.addEventListener('click', () => {
      resultSection.style.display = 'none';
    });

    function showResults(type){
      if(!flowers.length){
        // JSON まだなら少し待って再試行
        setTimeout(() => showResults(type), 200);
        return;
      }
      const results = flowers.filter(f => f.scene.includes(type));
      list.innerHTML = '';
      if(!results.length){
        list.innerHTML = '<p>該当する花は見つかりませんでした。</p>';
      } else {
        results.forEach(f => {
          const card = document.createElement('div');
          card.className = 'flower-card';
          card.innerHTML = `<h3>${f.name}</h3><p>花言葉: ${f.meaning}</p><p>注意点: ${f.caution}</p>`;
          list.appendChild(card);
        });
      }
      title.textContent = `${btnLabel(type)}におすすめの花`;
      resultSection.style.display = 'block';
      window.scrollTo({top:0,behavior:'smooth'});
    }

    function btnLabel(type){
      switch(type){
        case 'birthday': return '誕生日プレゼント';
        case 'hospital': return 'お見舞い';
        case 'farewell': return '送別・退職祝い';
        case 'casual': return 'ちょっとした贈り物';
        default: return '';
      }
    }
  </script>
</body>
</html>
